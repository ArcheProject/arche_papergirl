<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:metal="http://xml.zope.org/namespaces/metal"
      xmlns:tal="http://xml.zope.org/namespaces/tal"
      xmlns:i18n="http://xml.zope.org/namespaces/i18n"
      metal:use-macro="view.macro('arche:templates/base_view.pt', 'arche:templates/inline.pt')"
      i18n:domain="arche_papergirl">
<body>
<div metal:fill-slot="main-content">

  <h1 i18n:translate="">Outbox</h1>

  <tal:iter repeat="(list_uid, rec_uids) context.pending.items()">
    <tal:defs define="email_list request.resolve_uid(list_uid)">
      <tal:list condition="email_list">
        <h2>${email_list.title}</h2>
        To process: <span data-to-process-for="${list_uid}">${len(rec_uids)}</span>
        Pending: <span data-pending-for="${list_uid}">${len(rec_uids)}</span>

        <div class="progress" tal:condition="rec_uids">
          <div data-progress-for="${list_uid}"
               class="progress-bar progress-bar-success"
               role="progressbar"
               aria-valuenow="0"
               aria-valuemin="0"
               aria-valuemax="100"
               style="width: 0%">
          </div>
        </div>

        <a href="${request.resource_url(context,'manual_send.json', query = {'list_uid': list_uid})}"
           tal:condition="len(rec_uids)"
           data-send-list-for="${list_uid}"
          class="btn btn-success">
          <span data-actionmarker="glyphicon glyphicon-refresh rotate-me"></span>
          Manual send</a>
      </tal:list>
      <tal:list_removed condition="not email_list">
        <h2 class="text-muted">&lt;Removed list&gt;</h2>
        Pending: ${len(rec_uids)}
      </tal:list_removed>
    </tal:defs>
  </tal:iter>

</div>
</body>
</html>
